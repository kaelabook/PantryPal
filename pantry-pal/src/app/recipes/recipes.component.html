<app-navbar></app-navbar>

<div class="recipes-container">
  <!-- "Your Recipes" Title -->
  <h2 class="center-heading">Your Recipes</h2>

  <!-- Grid Layout for Saved Recipes -->
  <div class="recipes-grid">
    <div class="recipe-card" *ngFor="let recipe of savedRecipes">
      <h3>{{ recipe.name }}</h3>
      <p class="recipe-description">{{ recipe.description | slice:0:100 }}...</p>

      <div class="ingredients-list">
        <strong>Ingredients:</strong>
        <ul>
          <li *ngFor="let ingredient of recipe.ingredients">
            {{ ingredient.name }} ({{ ingredient.quantity }} {{ ingredient.unit }})
          </li>
        </ul>
      </div>

      <!-- Buttons: View, Edit, Delete, Share -->
      <div class="button-group">
        <button class="view-btn" (click)="viewRecipe(recipe)">View</button>
        <button class="edit-btn" (click)="editRecipe(recipe)">Edit</button>
        <button class="delete-btn" (click)="deleteRecipe(recipe)">Delete</button>
        <button class="share-btn" (click)="shareRecipe(recipe)">Share</button>
      </div>
    </div>
  </div>

  <button class="floating-button" (click)="toggleRecipeForm()">+</button>
</div>

<!-- Popup for Viewing Recipe Details -->
<div class="popup" *ngIf="selectedRecipe">
  <div class="popup-content">
    <h2>{{ selectedRecipe.name }}</h2>
    <p><strong>Cook Time:</strong> {{ selectedRecipe.cookTime }} mins</p>
    <p><strong>Temperature:</strong> {{ selectedRecipe.temperature }} °F</p>
    <p><strong>Servings:</strong> {{ selectedRecipe.servings }}</p>
    <p><strong>Ingredients:</strong></p>
    <ul>
      <li *ngFor="let ingredient of selectedRecipe.ingredients">{{ ingredient.name }} - {{ ingredient.quantity }} {{ ingredient.unit }}</li>
    </ul>
    <p><strong>Instructions:</strong></p>
    <p>{{ selectedRecipe.instructions }}</p>

    <button (click)="closeRecipeView()">Close</button>
  </div>
</div>

<!-- Popup Form for Adding or Editing a Recipe -->
<div class="popup" *ngIf="showRecipeForm">
  <form (ngSubmit)="saveRecipe()">
    <h2>{{ isEditing ? 'Edit' : 'Create' }} Recipe</h2>

    <label for="recipeName">Recipe Name:</label>
    <input type="text" id="recipeName" [(ngModel)]="currentRecipe.name" name="recipeName" required>

    <label for="recipeDescription">Description:</label>
    <textarea id="recipeDescription" [(ngModel)]="currentRecipe.description" name="recipeDescription"></textarea>

    <div class="ingredients-section">
      <h3>Ingredients</h3>
      <div class="ingredient-scroll-container">
        <div *ngFor="let ingredient of currentRecipe.ingredients; let i = index" class="ingredient-form">
          <h4>Ingredient {{ i + 1 }}</h4>
          <label for="ingredientName{{ i }}">Name:</label>
          <input type="text" [(ngModel)]="ingredient.name" name="ingredientName{{ i }}" required>

          <label for="ingredientQuantity{{ i }}">Quantity:</label>
          <input type="number" [(ngModel)]="ingredient.quantity" name="ingredientQuantity{{ i }}" required>

          <label for="ingredientUnit{{ i }}">Unit:</label>
          <input type="text" [(ngModel)]="ingredient.unit" name="ingredientUnit{{ i }}">

          <button type="button" (click)="removeIngredient(i)" class="delete-button">Remove Ingredient</button>
        </div>
      </div>
      <button type="button" (click)="addIngredient()" class="add-ingredient-btn">Add Ingredient</button>
    </div>

    <label for="recipeInstructions">Instructions:</label>
    <textarea id="recipeInstructions" [(ngModel)]="currentRecipe.instructions" name="recipeInstructions" required></textarea>

    <div class="slider-group">
      <label for="cookTime">Cook Time (minutes):</label>
      <input type="range" id="cookTime" [(ngModel)]="currentRecipe.cookTime" name="cookTime" min="1" max="480" step="1">
      <span>{{ currentRecipe.cookTime }} minutes</span>
    </div>

    <div class="slider-group">
      <label for="temperature">Temperature (°F):</label>
      <input type="range" id="temperature" [(ngModel)]="currentRecipe.temperature" name="temperature" min="100" max="500" step="1">
      <span>{{ currentRecipe.temperature }}°F</span>
    </div>

    <div class="submit-row">
      <button type="button" (click)="toggleRecipeForm()">Cancel</button>
      <button type="submit">{{ isEditing ? 'Save' : 'Create' }} Recipe</button>
    </div>
  </form>
</div>